[["spatial.html", "Chapter 1 Spatial", " Chapter 1 Spatial # load packages library(ggplot2) library(sf) ## Linking to GEOS 3.8.0, GDAL 3.0.4, PROJ 6.3.1 library(rnaturalearth) library(rnaturalearthdata) library(ggrepel) library(ggspatial) library(maps) library(tools) # build map world &lt;- ne_countries(scale = &quot;medium&quot;, returnclass = &quot;sf&quot;) class(world) ## [1] &quot;sf&quot; &quot;data.frame&quot; states &lt;- st_as_sf(map(&quot;state&quot;, plot = FALSE, fill = TRUE)) head(states) ## Simple feature collection with 6 features and 1 field ## geometry type: MULTIPOLYGON ## dimension: XY ## bbox: xmin: -124.3834 ymin: 30.24071 xmax: -71.78015 ymax: 42.04937 ## geographic CRS: WGS 84 ## ID geom ## 1 alabama MULTIPOLYGON (((-87.46201 3... ## 2 arizona MULTIPOLYGON (((-114.6374 3... ## 3 arkansas MULTIPOLYGON (((-94.05103 3... ## 4 california MULTIPOLYGON (((-120.006 42... ## 5 colorado MULTIPOLYGON (((-102.0552 4... ## 6 connecticut MULTIPOLYGON (((-73.49902 4... states &lt;- cbind(states, st_coordinates(st_centroid(states))) states$ID &lt;- toTitleCase(states$ID) head(states) ## Simple feature collection with 6 features and 3 fields ## geometry type: MULTIPOLYGON ## dimension: XY ## bbox: xmin: -124.3834 ymin: 30.24071 xmax: -71.78015 ymax: 42.04937 ## geographic CRS: WGS 84 ## ID X Y geom ## 1 Alabama -86.83042 32.80316 MULTIPOLYGON (((-87.46201 3... ## 2 Arizona -111.66786 34.30060 MULTIPOLYGON (((-114.6374 3... ## 3 Arkansas -92.44013 34.90418 MULTIPOLYGON (((-94.05103 3... ## 4 California -119.60154 37.26901 MULTIPOLYGON (((-120.006 42... ## 5 Colorado -105.55251 38.99797 MULTIPOLYGON (((-102.0552 4... ## 6 Connecticut -72.72598 41.62566 MULTIPOLYGON (((-73.49902 4... archcentroids &lt;- data.frame(arch = c(&quot;Camp County&quot;, &quot;Harrison County&quot;, &quot;Nacogdoches County&quot;, &quot;San Augustine County&quot;, &quot;Smith County&quot;, &quot;Shelby County&quot;), lat = c(32.97, 32.55, 31.61, 31.4, 32.38, 31.79), lng = c(-94.98, -94.37, -94.61, -94.18, -95.27, -94.14)) states$nudge_x &lt;- -0.55 states$nudge_x[states$ID == &quot;Texas&quot;] &lt;- 2 states$nudge_x[states$ID == &quot;Mississippi&quot;] &lt;- -0.1 states$nudge_y &lt;- -0.01 states$nudge_y[states$ID == &quot;Louisiana&quot;] &lt;- -0.25 states$nudge_y[states$ID == &quot;Arkansas&quot;] &lt;- -1 # plot map ggplot(data = world) + geom_sf(fill = &quot;#FFFFCC&quot;) + geom_sf(data = states, fill = NA) + geom_text(data = states, aes(X, Y, label = ID), nudge_x = states$nudge_x, nudge_y = states$nudge_y, fontface = &quot;italic&quot;, size = 2) + geom_text_repel(data = archcentroids, aes(x = lng, y = lat, label = arch), fontface = &quot;bold&quot;, nudge_x = c(0,1,-0.25,-0.25,-0.25,1), nudge_y = c(0.5,0,-0.5,-0.5,-0.25,0.01), color = &quot;#003366&quot;, size = 2.5) + coord_sf(xlim = c(-98, -89), ylim = c(30, 34.5), expand = TRUE) + ggtitle(&quot;Perdiz Arrow Point Sample Locations&quot;, subtitle = &quot;(archaeological site locations redacted)&quot;) + annotation_scale(location = &quot;bl&quot;, width_hint = 0.3) + annotation_north_arrow(location = &quot;bl&quot;, which_north = &quot;true&quot;, pad_x = unit(0.01, &quot;in&quot;), pad_y = unit(0.2, &quot;in&quot;), style = north_arrow_fancy_orienteering) + theme(panel.grid.major = element_line(color = gray(0.5), linetype = &quot;dashed&quot;, size = 0.5), panel.background = element_rect(fill = &quot;aliceblue&quot;)) + labs(x = &quot;Longitude&quot;, y = &quot;Latitude&quot;) "]]
